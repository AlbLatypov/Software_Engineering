# Nginx - реверс прокси

Nginx и реверсивный (обратный) прокси — это два понятия, которые часто встречаются в контексте веб-разработки и администрирования серверов. Чтобы понять, что такое реверсивный прокси и зачем он нужен, давайте сначала разберёмся с базовыми понятиями.

### Что такое Nginx?

Nginx (произносится как "Engine-X") — это асинхронный веб-сервер и прокси-сервер для HTTP, HTTPS, SMTP, POP3 и IMAP протоколов. Он известен своей высокой производительностью, стабильностью, богатыми функциональными возможностями, простотой конфигурации и низким потреблением ресурсов.

### Что такое прокси?

Прокси-сервер — это сервер, который действует как посредник между клиентом (например, вашим браузером) и другим сервером (например, веб-сайтом). Клиент соединяется с прокси-сервером, запрашивает какой-то ресурс (например, веб-страницу), после чего прокси соединяется с целевым сервером, получает ресурс и передаёт его клиенту.

### Что такое реверсивный прокси?

Реверсивный прокси (reverse proxy) работает наоборот по сравнению с обычным прокси. В этом случае прокси-сервер располагается перед одним или несколькими серверами, и все запросы, идущие к этим серверам, проходят через прокси.

То есть при использовании реверсивного прокси:

 - Клиент посылает запрос на прокси-сервер (который выступает как фронтенд).
 - Реверсивный прокси принимает запрос и перенаправляет его на один из множества реальных серверов (которые выступают как бэкенды).
 - Бэкенд-сервер обрабатывает запрос и возвращает ответ реверсивному прокси.
 - Реверсивный прокси затем передаёт ответ обратно клиенту.

### Зачем нужен реверсивный прокси?

* Балансировка нагрузки: Реверсивные прокси могут распределять входящий трафик между несколькими серверами, тем самым распределяя нагрузку и увеличивая общую пропускную способность и надёжность системы.

* Усиление безопасности: Реверсивный прокси может скрыть истинные IP-адреса бэкенд-серверов, обеспечивая дополнительный уровень абстракции и безопасности от атак.

* Кэширование контента: Реверсивные прокси могут кэшировать входящие запросы и отдавать статический контент (например, изображения, CSS, JavaScript), не обращаясь к бэкенд-серверу. Это снижает время загрузки страниц и сокращает нагрузку на бэкенд-серверы.

* Управление SSL/TLS: Реверсивный прокси может обрабатывать шифрование и дешифрование HTTPS-трафика, снимая эту нагрузку с бэкенд-серверов и централизуя управление сертификатами SSL/TLS.

* Компрессия и оптимизация: Реверсивный прокси может выполнять сжатие данных на лету, оптимизируя трафик и улучшая время загрузки.

* Унификация доступа к сервисам: Реверсивный прокси может обеспечивать единый точный доступ к различным внутренним сервисам, упрощая структуру сети и управление.

### Пример использования Nginx как реверсивного прокси

Допустим, у вас есть два веб-сервера, которые обслуживают одно приложение. Nginx можно настроить как реверсивный прокси, чтобы он принимал все входящие HTTP-запросы и распределял их между двумя серверами. Пример конфигурации Nginx:
```bash
http {
    upstream myapp1 {
        server srv1.example.com;
        server srv2.example.com;
    }

    server {
        listen 80;

        location / {
            proxy_pass http://myapp1;
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            proxy_set_header X-Forwarded-Proto $scheme;
        }
    }
}
```
В этом примере:

* upstream myapp1 определяет группу серверов, между которыми будет распределяться нагрузка.
* proxy_pass указывает на группу серверов, к которой следует перенаправлять запросы.
* proxy_set_header используется для переопределения или добавления HTTP-заголовков в передаваемый запрос.

### Таким образом, реверсивный прокси на базе Nginx помогает улучшить производительность, безопасность и масштабируемость веб-приложений.
